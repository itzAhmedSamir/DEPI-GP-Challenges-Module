import{a as F,b as L,c as T,d as j}from"./chunk-5BEIWVDZ.js";import{A as b,E as k,F as D,G as I,I as E,K as z,a as h,b as C,h as x,i as M,j as r,k as d,l as y,m as v,o as m,p as t,q as o,r as O,s as P,t as _,u as f,v as S,w,y as n,z as s}from"./chunk-XUJENBMA.js";function N(l,i){l&1&&(t(0,"section",3)(1,"div",4)(2,"div",5),n(3,"Loading challenge details..."),o()()())}function R(l,i){if(l&1){let e=P();t(0,"div",29)(1,"div",30)(2,"span",31),n(3),o(),t(4,"div")(5,"div",32),n(6),o(),t(7,"div",33),n(8),o()()(),t(9,"button",34),_("click",function(){let c=x(e).index,g=f(2);return M(g.markDayComplete(c))}),n(10),o()()}if(l&2){let e=i.$implicit,a=i.index;w("completed",e),r(3),s(e?"\u2705":"\u23F3"),r(3),b("Day ",a+1),r(2),s(e?"Completed":"Pending"),r(),m("disabled",e),r(),b(" ",e?"Done \u2713":"Mark as Done"," ")}}function B(l,i){if(l&1&&(t(0,"div",35)(1,"div",36)(2,"div",37),n(3,"\u{1F3C6}"),o(),t(4,"h3"),n(5,"Challenge Completed!"),o(),t(6,"p"),n(7,"Congratulations! You've earned "),t(8,"span"),n(9),o(),n(10," points"),o()()()),l&2){let e=f(2);r(9),s(e.challenge.points)}}function A(l,i){if(l&1){let e=P();t(0,"section",3)(1,"div",4)(2,"div",6)(3,"div",7)(4,"div",8),n(5),o(),t(6,"h2",9),n(7),o(),t(8,"p",10),n(9),o()(),t(10,"div",11)(11,"div",12)(12,"span",13),n(13,"Overall Progress"),o(),t(14,"span",14),n(15),o()(),t(16,"div",15)(17,"div",16),O(18,"div",17),o()()(),t(19,"div",18)(20,"div",19)(21,"span",20),n(22,"\u23F1\uFE0F"),o(),t(23,"span",21),n(24,"Duration: "),t(25,"strong"),n(26),o(),n(27," days"),o()(),t(28,"div",19)(29,"span",20),n(30,"\u2B50"),o(),t(31,"span",21),n(32,"Points: "),t(33,"strong"),n(34),o()()(),t(35,"div",19)(36,"span",20),n(37,"\u{1F4C5}"),o(),t(38,"span",21),n(39,"Started: "),t(40,"strong"),n(41),o()()()(),t(42,"div",22)(43,"button",23),_("click",function(){x(e);let c=f();return M(c.leaveChallenge())}),n(44," Leave Challenge "),o()(),t(45,"div",24)(46,"h3",25),n(47,"\u{1F4C6} Daily Timeline"),o(),t(48,"div",26),v(49,R,11,7,"div",27),o()(),v(50,B,11,1,"div",28),o()()()}if(l&2){let e=f();r(5),s(e.challenge.icon),r(2),s(e.challenge.title),r(2),s(e.challenge.description),r(6),b("",e.stats.percentage,"%"),r(3),S("width",e.stats.percentage,"%"),r(8),s(e.challenge.durationDays),r(8),s(e.challenge.points),r(7),s(e.formatDate(e.userChallenge.startedAt)),r(8),m("ngForOf",e.userChallenge.progress),r(),m("ngIf",e.isFullyCompleted)}}var V=class l{constructor(i,e,a,c,g){this.route=i;this.router=e;this.challengeService=a;this.notificationService=c;this.storageService=g}challenge=null;userChallenge=null;stats={completed:0,total:0,percentage:0};isFullyCompleted=!1;isLoading=!0;challengeId=0;ngOnInit(){window.scrollTo(0,0),this.route.params.subscribe(i=>{this.challengeId=+i.id,this.loadChallengeDetails()})}loadChallengeDetails(){if(this.isLoading=!0,this.challenge=this.challengeService.getChallengeDefinition(this.challengeId)||null,this.userChallenge=this.challengeService.getUserChallenge(this.challengeId),!this.challenge||!this.userChallenge){this.notificationService.error("Challenge Not Found","This challenge does not exist or you have not joined it yet.").then(()=>{this.router.navigate(["/challenges"])});return}this.updateStats(),this.isLoading=!1}updateStats(){this.userChallenge&&(this.stats=this.challengeService.getChallengeStats(this.userChallenge),this.isFullyCompleted=this.userChallenge.progress.every(i=>i===!0))}markDayComplete(i){if(!this.userChallenge||this.userChallenge.progress[i])return;let e=this.challengeService.markDayComplete(this.challengeId,i);e.success&&(this.userChallenge=this.challengeService.getUserChallenge(this.challengeId),this.updateStats(),e.isFullyCompleted?this.showCompletionCelebration(e.newBadges):this.notificationService.success("Day Completed!",`Day ${i+1} marked as done! Keep it up! \u{1F4AA}`,2e3))}showCompletionCelebration(i){this.challenge&&(i.length>0?this.showBigFireworks():this.showSmallConfetti(),this.notificationService.challengeCompleted(this.challenge.points,i))}showSmallConfetti(){if(typeof confetti!="function")return;let i=200,e={origin:{y:.7}};function a(c,g){confetti(C(h(h({},e),g),{particleCount:Math.floor(i*c)}))}a(.25,{spread:26,startVelocity:55}),a(.2,{spread:60}),a(.35,{spread:100,decay:.91,scalar:.8}),a(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2}),a(.1,{spread:120,startVelocity:45})}showBigFireworks(){if(typeof confetti!="function")return;let i=5*1e3,e=Date.now()+i,a={startVelocity:30,spread:360,ticks:60,zIndex:1e3};function c(p,u){return Math.random()*(u-p)+p}let g=setInterval(function(){let p=e-Date.now();if(p<=0)return clearInterval(g);let u=50*(p/i);confetti(C(h({},a),{particleCount:u,origin:{x:c(.1,.3),y:Math.random()-.2}})),confetti(C(h({},a),{particleCount:u,origin:{x:c(.7,.9),y:Math.random()-.2}}))},250)}leaveChallenge(){this.challenge&&this.notificationService.confirmDanger("Leave Challenge?",`<p>Are you sure you want to leave <strong>"${this.challenge.title}"</strong>?</p><p style="color: #fc8181; margin-top: 1rem;">\u26A0\uFE0F Your progress will be lost.</p>`,"Yes, Leave It","Keep Challenge").then(i=>{i&&this.challengeService.leaveChallenge(this.challengeId)&&this.notificationService.success("Challenge Left","You have left the challenge. You can always join again!",2500).then(()=>{this.router.navigate(["/challenges"])})})}formatDate(i){return new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}goBack(){this.router.navigate(["/challenges"])}static \u0275fac=function(e){return new(e||l)(d(E),d(z),d(T),d(j),d(L))};static \u0275cmp=y({type:l,selectors:[["app-challenge-details"]],decls:6,vars:2,consts:[[1,"container",2,"margin-top","100px"],[1,"back-btn",3,"click"],["class","challenge-details-section",4,"ngIf"],[1,"challenge-details-section"],[1,"container"],[1,"empty-message"],[1,"challenge-details-card"],[1,"challenge-header"],[1,"challenge-icon-large"],[1,"challenge-title-large"],[1,"challenge-description"],[1,"progress-section"],[1,"progress-header"],[1,"progress-label"],[1,"progress-percentage"],[1,"progress-bar-container"],[1,"progress-bar"],[1,"progress-fill"],[1,"challenge-info-grid"],[1,"info-item"],[1,"info-icon"],[1,"info-text"],[1,"action-buttons"],[1,"btn-secondary",3,"click"],[1,"timeline-section"],[1,"timeline-title"],[1,"timeline-grid"],["class","timeline-item",3,"completed",4,"ngFor","ngForOf"],["class","completion-badge",4,"ngIf"],[1,"timeline-item"],[1,"timeline-day"],[1,"day-icon"],[1,"day-label"],[1,"day-status"],[1,"mark-done-btn",3,"click","disabled"],[1,"completion-badge"],[1,"badge-content"],[1,"badge-icon"]],template:function(e,a){e&1&&(O(0,"app-header"),t(1,"section",0)(2,"a",1),_("click",function(){return a.goBack()}),n(3,"\u2190 Back to Challenges"),o()(),v(4,N,4,0,"section",2)(5,A,51,11,"section",2)),e&2&&(r(4),m("ngIf",a.isLoading),r(),m("ngIf",!a.isLoading&&a.challenge&&a.userChallenge))},dependencies:[I,k,D,F],styles:[".back-btn[_ngcontent-%COMP%]{display:inline-block;color:var(--success-color);text-decoration:none;font-weight:600;margin-bottom:2rem;transition:color .3s ease;cursor:pointer}.back-btn[_ngcontent-%COMP%]:hover{color:#38a169}.challenge-details-section[_ngcontent-%COMP%]{padding:2rem 0 4rem;margin-top:10px}.challenge-details-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--dark-bg) 0%,var(--secondary-bg) 100%);border:1px solid var(--border-color);border-radius:16px;padding:2.5rem;animation:fadeIn .6s ease}.challenge-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.challenge-icon-large[_ngcontent-%COMP%]{font-size:5rem;margin-bottom:1rem;animation:bounce 2s infinite}.challenge-title-large[_ngcontent-%COMP%]{font-size:2.5rem;margin-bottom:1rem}.progress-section[_ngcontent-%COMP%]{margin:2rem 0}.progress-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.progress-label[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem}.progress-percentage[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--success-color)}.progress-bar-container[_ngcontent-%COMP%]{background-color:#ffffff1a;border-radius:50px;overflow:hidden;height:30px}.progress-bar[_ngcontent-%COMP%]{width:100%;height:100%}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,var(--success-color) 0%,#38a169 100%);border-radius:50px;transition:width .5s ease;display:flex;align-items:center;justify-content:flex-end;padding-right:10px;color:#fff;font-weight:700}.challenge-info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1.5rem;margin:2rem 0}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:1rem;background-color:#ffffff0d;border-radius:8px;border:1px solid var(--border-color)}.info-icon[_ngcontent-%COMP%]{font-size:1.5rem}.info-text[_ngcontent-%COMP%]{color:var(--text-secondary)}.action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem;margin:2rem 0}.timeline-section[_ngcontent-%COMP%]{margin-top:3rem}.timeline-title[_ngcontent-%COMP%]{font-size:1.8rem;margin-bottom:1.5rem}.timeline-grid[_ngcontent-%COMP%]{display:grid;gap:1rem}.timeline-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;background-color:#ffffff0d;border-radius:10px;border:1px solid var(--border-color);transition:all .3s ease}.timeline-item[_ngcontent-%COMP%]:hover{background-color:#ffffff14;border-color:var(--success-color)}.timeline-item.completed[_ngcontent-%COMP%]{background-color:#48bb781a;border-color:var(--success-color)}.timeline-day[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.day-icon[_ngcontent-%COMP%]{font-size:1.8rem}.day-label[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem}.day-status[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-secondary)}.mark-done-btn[_ngcontent-%COMP%]{padding:.6rem 1.5rem;background:linear-gradient(135deg,var(--success-color) 0%,#38a169 100%);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease}.mark-done-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.05);box-shadow:0 4px 12px #48bb7866}.mark-done-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.95)}.mark-done-btn[_ngcontent-%COMP%]:disabled{background:linear-gradient(135deg,#4a5568,#2d3748);cursor:not-allowed;opacity:.6;transform:none}.completion-badge[_ngcontent-%COMP%]{margin-top:2rem;padding:2rem;background:linear-gradient(135deg,#f6ad5533,#ed893633);border:2px solid var(--warning-color);border-radius:12px;animation:pulse 2s infinite}.badge-content[_ngcontent-%COMP%]{text-align:center}.badge-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.badge-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:2rem;color:var(--warning-color);margin-bottom:.5rem}.badge-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:1.1rem}.badge-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--warning-color);font-weight:700}@media (max-width: 768px){.challenge-details-card[_ngcontent-%COMP%]{padding:1.5rem}.challenge-title-large[_ngcontent-%COMP%]{font-size:2rem}.challenge-icon-large[_ngcontent-%COMP%]{font-size:4rem}.timeline-item[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}.timeline-day[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.mark-done-btn[_ngcontent-%COMP%]{width:100%}}@media (max-width: 480px){.challenge-details-card[_ngcontent-%COMP%]{padding:1.25rem}.challenge-icon-large[_ngcontent-%COMP%]{font-size:3.5rem}.challenge-title-large[_ngcontent-%COMP%]{font-size:1.5rem}.progress-label[_ngcontent-%COMP%]{font-size:1rem}.progress-percentage[_ngcontent-%COMP%]{font-size:1.2rem}.progress-bar-container[_ngcontent-%COMP%]{height:25px}.challenge-info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.info-item[_ngcontent-%COMP%]{padding:.875rem}.timeline-title[_ngcontent-%COMP%]{font-size:1.4rem}.timeline-item[_ngcontent-%COMP%]{padding:1.25rem}.day-icon[_ngcontent-%COMP%]{font-size:1.5rem}.day-label[_ngcontent-%COMP%]{font-size:1rem}.mark-done-btn[_ngcontent-%COMP%]{padding:.7rem 1rem;font-size:.9rem}.badge-icon[_ngcontent-%COMP%]{font-size:3rem}.badge-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem}.badge-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 360px){.timeline-title[_ngcontent-%COMP%]{font-size:1.3rem}}"]})};export{V as ChallengeDetailsComponent};
